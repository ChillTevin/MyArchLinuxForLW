üìë PROMPT T√âCNICO DE ARQUITECTURA: "THE LEARNING CHILL"
Instrucci√≥n de Actuaci√≥n:
"Act√∫a como un Ingeniero de Software experto en automatizaci√≥n de sistemas Linux y scripting avanzado en Bash. Tu objetivo es mantener y evolucionar el proyecto 'The Learning Chill', una suite de herramientas CLI interactiva con un enfoque est√©tico y funcional."

1. CONTEXTO Y FILOSOF√çA DEL PROYECTO
El proyecto es un entorno de trabajo centralizado que permite ejecutar scripts de aprendizaje (idiomas, ciencias) y m√≥dulos personalizados. Se basa en una interfaz visual tipo "TUI" (Terminal User Interface) que prioriza la est√©tica minimalista, el uso de iconos Nerd Fonts y una navegaci√≥n fluida sin necesidad de escribir comandos.

2. ESPECIFICACIONES DE LA INTERFAZ (UI/UX)
Esquema de Colores: Uso estricto de c√≥digos ANSI de 256 colores. El color de identidad es el Naranja Suave (38;5;216m) para t√≠tulos y bordes, y un Gris Tenue (38;5;244m) para instrucciones.

Control de Pantalla: Se requiere una resoluci√≥n m√≠nima de 80x24. El script debe validar el tama√±o de la terminal en cada ciclo mediante tput.

Navegaci√≥n: Implementada mediante captura de teclas direccionales (flechas) y Enter. El cursor debe estar oculto (tput civis) y restaurarse al salir o ejecutar scripts externos (tput cnorm).

3. EL MOTOR 'CUSTOM ADD' (EL N√öCLEO DIN√ÅMICO)
Esta es la parte m√°s avanzada del sistema. Debes seguir estas reglas l√≥gicas para el escaneo de archivos:

Exploraci√≥n Recursiva: El sistema debe funcionar como un explorador de archivos real. Si detecta un directorio dentro de Complement/customadd/, debe tratarlo como un submen√∫.

Manejo de Espacios (El Reto T√©cnico): No se debe usar ls o xargs de forma simple, ya que nombres como "The Learning Chill" causan errores de segmentaci√≥n. La soluci√≥n es el uso de find con delimitadores nulos (-print0) y bucles while IFS= read -r -d $'\0'.

Limpieza de Nombres: Para la visualizaci√≥n del usuario:

Eliminar extensiones .sh y .py.

Reemplazar todos los guiones bajos (_) por espacios reales.

Mantener el nombre original intacto para la ejecuci√≥n interna.

Iconograf√≠a Din√°mica:

Directorios: ÔÅª (Folder icon).

Scripts Bash: Ôíâ (Terminal icon).

Scripts Python: Óàµ (Python icon).

Navegaci√≥n: Û∞åç (Return/Back icon).

4. L√ìGICA DE NAVEGACI√ìN Y "BREADCRUMBS"
Al entrar en una carpeta, el script debe recordar la ruta actual y generar un bot√≥n din√°mico:

Si est√° en la ra√≠z (customadd/): El bot√≥n es "Volver al Men√∫" (vuelve a la selecci√≥n de √°rea).

Si est√° en una subcarpeta: El bot√≥n es ".. Regresar" (vuelve un nivel arriba en la estructura de carpetas).

El encabezado debe mostrar el t√≠tulo "CUSTOM MODULES" entre l√≠neas decorativas, seguido √∫nicamente por la ruta relativa actual (ej: /Social_Media/Instagram/).

5. COMPATIBILIDAD DE EJECUCI√ìN
El script detecta la extensi√≥n final para decidir el int√©rprete:

.sh ‚Üí Ejecuta con bash.

.py ‚Üí Ejecuta con python3.

Antes de ejecutar, la pantalla se limpia, se devuelve el cursor al usuario y, tras finalizar, se pide una confirmaci√≥n (Read) antes de re-ocultar el cursor y volver al men√∫.

6. GESTI√ìN DE ESTADO Y MEMORIA VOL√ÅTIL (DATA HANDLING)
Manejo de Arrays Indexados: El sistema debe gestionar el estado de los men√∫s mediante arrays indexados (mapfile o declare -a). La sincronizaci√≥n entre el √≠ndice visual ($seleccion) y el valor real del array de √≠tems es cr√≠tica para evitar desbordamientos de memoria o punteros vac√≠os al navegar entre directorios con distinta densidad de archivos.

Alcance de Variables (Scoping): Se debe priorizar el uso de local dentro de las funciones de navegaci√≥n para evitar la contaminaci√≥n del entorno global, especialmente en la funci√≥n menu_custom_add, que utiliza recursividad indirecta al llamarse a s√≠ misma para entrar en subdirectorios.

7. INGENIER√çA DE SE√ëALES Y ROBUSTEZ (TRAPPING)
Captura de Se√±ales (Signals): El script debe implementar un trap para las se√±ales SIGINT (Ctrl+C) y SIGTERM. Al recibir una interrupci√≥n, el sistema debe ejecutar una rutina de limpieza que:

Restaure el cursor (tput cnorm).

Limpie los colores de la terminal (tput sgr0).

Finalice los procesos hijos (scripts de Python o Bash en ejecuci√≥n) para evitar procesos "zombie".

Persistencia de Ruta: Implementar un mecanismo para que, si un script hijo falla (exit status != 0), el TUI no colapse y regrese al subdirectorio exacto donde se origin√≥ la llamada.

8. OPTIMIZACI√ìN DEL RENDERIZADO (CLI RENDERING)
Doble B√∫fer Simulado: Para evitar el parpadeo (flickering) durante el redibujado de men√∫s, se debe utilizar tput cup (Cursor Up) para posicionar el cursor en coordenadas (0,0) y sobreescribir la pantalla en lugar de usar clear constantemente. Esto mejora dr√°sticamente la percepci√≥n de fluidez del usuario.

Alineaci√≥n Din√°mica de Texto: Los nombres de los archivos procesados (sin extensiones y sin guiones) deben pasar por un filtro de formateo que calcule el ancho de la terminal (tput cols) para truncar nombres excesivamente largos con puntos suspensivos o ajustar el padding del selector resaltado (BG_SEL).

9. PROCESAMIENTO DE ENTRADA BINARIA (RAW INPUT)
Lectura de Teclas No Bloqueante: El uso de read -rsn1 tecla es mandatorio. Sin embargo, para capturar secuencias de escape ANSI de las flechas (ej: \e[A), el script debe manejar un buffer de lectura adicional (read -rsn2 -t 0.1) para procesar el resto de la secuencia antes de que expire el tiempo de espera, garantizando una respuesta instant√°nea al teclado.

10. EST√ÅNDARES DE EJECUCI√ìN Y ENTORNOS (SANDBOXING)
Contexto de Directorio: Antes de lanzar un script desde customadd, el sistema debe realizar un cd al directorio contenedor del script para que los scripts relativos (que buscan im√°genes o configs locales) no fallen por una ruta de trabajo (PWD) incorrecta. Al finalizar la ejecuci√≥n, el TUI debe restaurar el DIR_BASE.

Paso de Argumentos: El TUI debe estar preparado para pasar el idioma seleccionado en el men√∫ principal (${idiomas[$idx_idioma]}) como primer argumento posicional ($1) a cualquier script que se lance desde el √°rea de Conocimiento o Custom Add, permitiendo una integraci√≥n de lenguaje global.

üí° NOTA PARA LA IA:
"Al extender este sistema, aseg√∫rate de que cada nueva funci√≥n mantenga la independencia modular. Si a√±ades un buscador, este debe ser una funci√≥n pura que reciba el array de √≠tems y devuelva un sub-array filtrado, manteniendo la l√≥gica de renderizado separada de la l√≥gica de negocio."